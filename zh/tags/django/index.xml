<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/">
  <channel>
    <title>Django on Liberation Notes</title>
    <link>https://blog.cmwang.net/zh/tags/django/</link>
    <description>Recent content in Django on Liberation Notes</description>
    <image>
      <title>Liberation Notes</title>
      <url>https://blog.cmwang.net/47</url>
      <link>https://blog.cmwang.net/47</link>
    </image>
    <generator>Hugo -- gohugo.io</generator>
    <language>zh</language>
    <lastBuildDate>Sun, 25 Oct 2020 02:47:41 +0800</lastBuildDate><atom:link href="https://blog.cmwang.net/zh/tags/django/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>Django - Data Modelling</title>
      <link>https://blog.cmwang.net/zh/posts/2020/10/django-data-model/</link>
      <pubDate>Sun, 25 Oct 2020 02:47:41 +0800</pubDate>
      
      <guid>https://blog.cmwang.net/zh/posts/2020/10/django-data-model/</guid>
      <description>Django - Data Modelling</description>
      <content:encoded><![CDATA[<h2 id="create-model">Create Model</h2>
<ul>
<li>æœƒè‡ªå‹•ç”¢ç”Ÿ primary keyï¼Œå› ç‚ºç¹¼æ‰¿è‡ª <strong>models.Model</strong>ã€‚è‹¥æƒ³è¦è‡ªè¨‚ <code>primary key</code>ï¼Œå¯ä»¥åƒè€ƒ sku çš„å¯«æ³•</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># playground/models.py</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">django.db</span> <span class="kn">import</span> <span class="n">models</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Create your models here.</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Product</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="c1">#sku = models.CharField(max_length=10, primary_key=True) # use this primary key</span>
</span></span><span class="line"><span class="cl">    <span class="n">title</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">description</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">TextField</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">price</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">DecimalField</span><span class="p">(</span><span class="n">max_digits</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">decimal_places</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">inventory</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">IntegerField</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">last_updated</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">DateTimeField</span><span class="p">(</span><span class="n">auto_now</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># update every time</span>
</span></span></code></pre></div><h2 id="choices-field"><code>Choices</code> field</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Customer</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># best practice to prevent hardcode</span>
</span></span><span class="line"><span class="cl">    <span class="n">MEMBERSHIP_BRONZE</span> <span class="o">=</span> <span class="s1">&#39;B&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="n">MEMBERSHIP_SILVER</span> <span class="o">=</span> <span class="s1">&#39;S&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="n">MEMBERSHIP_GOLD</span> <span class="o">=</span> <span class="s1">&#39;G&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">MEMBERSHIP_CHOICES</span> <span class="o">=</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="p">(</span><span class="n">MEMBERSHIP_BRONZE</span><span class="p">,</span> <span class="s1">&#39;Bronze&#39;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">        <span class="p">(</span><span class="n">MEMBERSHIP_SILVER</span><span class="p">,</span> <span class="s1">&#39;Silver&#39;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">        <span class="p">(</span><span class="n">MEMBERSHIP_GOLD</span><span class="p">,</span> <span class="s1">&#39;Gold&#39;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="n">first_name</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">last_name</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">email</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">EmailField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span><span class="n">unique</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">phone</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">unique</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">birth_date</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">DateTimeField</span><span class="p">(</span><span class="n">null</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">blank</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">membership</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">choices</span><span class="o">=</span><span class="n">MEMBERSHIP_CHOICES</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">MEMBERSHIP_BRONZE</span><span class="p">)</span>
</span></span></code></pre></div><h2 id="one-to-one-relationship"><code>One-to-One</code> relationship</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Address</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">street</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">255</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">city</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">255</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># address is the child, customer is the parent</span>
</span></span><span class="line"><span class="cl">    <span class="n">customr</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">OneToOneField</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="n">Customer</span><span class="p">,</span> <span class="n">on_delete</span><span class="o">=</span><span class="n">models</span><span class="o">.</span><span class="n">CASCADE</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></span></code></pre></div><ul>
<li><strong><code>on_delete=models.CASCADE</code> (å±¤ç´šåˆªé™¤)</strong>: ç•¶çˆ¶æ¨¡å‹è¢«åˆªé™¤æ™‚ï¼Œèˆ‡ä¹‹ç›¸é—œè¯çš„å­æ¨¡å‹ä¹Ÿæœƒè¢«åˆªé™¤</li>
<li><strong><code>on_delete=models.PROTECT</code> (ä¿è­·æ¨¡å¼)</strong>: é˜²æ­¢åˆªé™¤çˆ¶æ¨¡å‹ï¼Œé™¤éå…ˆåˆªé™¤æ‰€æœ‰èˆ‡ä¹‹ç›¸é—œçš„å­æ¨¡å‹ã€‚</li>
<li><strong><code>on_delete=models.SET_NULL</code> (è¨­ç‚ºç©ºå€¼)</strong>: ç•¶çˆ¶æ¨¡å‹è¢«åˆªé™¤æ™‚ï¼Œèˆ‡ä¹‹ç›¸é—œè¯çš„å­æ¨¡å‹çš„å¤–éµæ¬„ä½ï¼ˆå³<code>OneToOneField</code>ï¼‰æœƒè¢«è¨­ç‚º NULLã€‚
<ul>
<li>ç¯„ä¾‹ï¼šä¸€å€‹ç°¡å–®çš„éƒ¨è½æ ¼ç³»çµ±ï¼Œå¦‚æœä¸€ç¯‡æ–‡ç« è¢«ä½œè€…åˆªé™¤ï¼Œè©²æ–‡ç« çš„ä½œè€…æ¬„ä½æœƒè¢«è¨­ç‚º NULLã€‚</li>
</ul>
</li>
<li><strong><code>on_delete=models.SET_DEFAULT</code> (è¨­ç‚ºé è¨­å€¼)</strong>: ç•¶çˆ¶æ¨¡å‹è¢«åˆªé™¤æ™‚ï¼Œèˆ‡ä¹‹ç›¸é—œè¯çš„å­æ¨¡å‹çš„å¤–éµæ¬„ä½æœƒè¢«è¨­ç‚ºé è¨­å€¼ã€‚
<ul>
<li>ç¯„ä¾‹ï¼šä¸€å€‹ç°¡å–®çš„éƒ¨è½æ ¼ç³»çµ±ï¼Œå¦‚æœä¸€ç¯‡æ–‡ç« è¢«ä½œè€…åˆªé™¤ï¼Œè©²æ–‡ç« çš„ä½œè€…æ¬„ä½æœƒè¢«è¨­ç‚º NULLã€‚</li>
</ul>
</li>
<li><strong><code>on_delete=models.SET()</code> (è¨­å®šç‚ºç‰¹å®šå€¼)</strong>: ç•¶çˆ¶æ¨¡å‹è¢«åˆªé™¤æ™‚ï¼Œèˆ‡ä¹‹ç›¸é—œè¯çš„å­æ¨¡å‹çš„å¤–éµæ¬„ä½æœƒè¢«è¨­ç‚ºç‰¹å®šçš„å€¼ï¼ˆé€šå¸¸æ˜¯å¦ä¸€å€‹å­˜åœ¨çš„æ¨¡å‹å¯¦ä¾‹ï¼‰ã€‚
<ul>
<li>ç¯„ä¾‹ï¼šä¸€å€‹è«–å£‡ç³»çµ±ï¼Œå¦‚æœä¸€å€‹ç”¨æˆ¶å¸³è™Ÿè¢«åˆªé™¤ï¼Œèˆ‡ä¹‹ç›¸é—œè¯çš„æ–‡ç« çš„ä½œè€…æ¬„ä½æœƒè¢«è¨­ç‚ºè«–å£‡çš„é è¨­ç”¨æˆ¶ï¼Œé€™å€‹é è¨­ç”¨æˆ¶çš„ ID ç‚º 1ã€‚</li>
</ul>
</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Child</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">parent</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">OneToOneField</span><span class="p">(</span><span class="n">Parent</span><span class="p">,</span> <span class="n">on_delete</span><span class="o">=</span><span class="n">models</span><span class="o">.</span><span class="n">CASCADE</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">...</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Child</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">parent</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">OneToOneField</span><span class="p">(</span><span class="n">Parent</span><span class="p">,</span> <span class="n">on_delete</span><span class="o">=</span><span class="n">models</span><span class="o">.</span><span class="n">PROTECT</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">...</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Child</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">parent</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">OneToOneField</span><span class="p">(</span><span class="n">Parent</span><span class="p">,</span> <span class="n">on_delete</span><span class="o">=</span><span class="n">models</span><span class="o">.</span><span class="n">SET_NULL</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">...</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Child</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">parent</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">OneToOneField</span><span class="p">(</span><span class="n">Parent</span><span class="p">,</span> <span class="n">on_delete</span><span class="o">=</span><span class="n">models</span><span class="o">.</span><span class="n">SET_DEFAULT</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">...</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Child</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">parent</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">OneToOneField</span><span class="p">(</span><span class="n">Parent</span><span class="p">,</span> <span class="n">on_delete</span><span class="o">=</span><span class="n">models</span><span class="o">.</span><span class="n">SET</span><span class="p">(</span><span class="n">DefaultParent</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="mi">1</span><span class="p">)))</span>
</span></span><span class="line"><span class="cl">    <span class="o">...</span>
</span></span></code></pre></div><h2 id="one-to-many-relationship"><code>One-to-many</code> relationship</h2>
<p>one collection can have many products</p>
<ul>
<li>
<p>Use <code>foreignkey</code></p>
</li>
<li>
<p>if you can not modify the order of declaration for the <code>collection</code> model, you can employ a <code>string argument</code> within the <code>ForeignKey</code> field:</p>
<p><code>collection = models.ForeignKey('Collection', on_delete=models.PROTECT)</code></p>
</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Collection</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">title</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Product</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="o">...</span>
</span></span><span class="line"><span class="cl">    <span class="n">collection</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span><span class="n">Collection</span><span class="p">,</span> <span class="n">on_delete</span><span class="o">=</span><span class="n">models</span><span class="o">.</span><span class="n">PROTECT</span><span class="p">)</span>
</span></span></code></pre></div><h2 id="many-to-many-relationship"><code>Many-to-Many</code> relationship</h2>
<ul>
<li>Use <code>ManyToManyField</code></li>
<li>to customize the name of the reverse relation. Instead of the default <code>product_set</code>, you can use the <code>related_name</code> field</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Promotion</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">description</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">255</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">discount</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">FloatField</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># product_set</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Product</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="o">...</span>
</span></span><span class="line"><span class="cl">    <span class="n">collection</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span><span class="s1">&#39;Collection&#39;</span><span class="p">,</span> <span class="n">on_delete</span><span class="o">=</span><span class="n">models</span><span class="o">.</span><span class="n">PROTECT</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="c1">#promotions = models.ManyToManyField(Promotion, related_name=&#39;products&#39;)</span>
</span></span><span class="line"><span class="cl">    <span class="n">promotions</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ManyToManyField</span><span class="p">(</span><span class="n">Promotion</span><span class="p">)</span>
</span></span></code></pre></div><h2 id="generic-relationship"><code>Generic</code> Relationship</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">django.contrib.contenttypes.models</span> <span class="kn">import</span> <span class="n">ContentType</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">django.contrib.contenttypes.fields</span> <span class="kn">import</span> <span class="n">GenericForeignKey</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">django.contrib.auth.models</span> <span class="kn">import</span> <span class="n">User</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">LikeItem</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">user</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span><span class="n">User</span><span class="p">,</span> <span class="n">on_delete</span><span class="o">=</span><span class="n">models</span><span class="o">.</span><span class="n">CASCADE</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># type (Table)</span>
</span></span><span class="line"><span class="cl">    <span class="n">content_type</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span><span class="n">ContentType</span><span class="p">,</span> <span class="n">on_delete</span><span class="o">=</span><span class="n">models</span><span class="o">.</span><span class="n">CASCADE</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># ID (record)</span>
</span></span><span class="line"><span class="cl">    <span class="n">object_id</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">PositiveSmallIntegerField</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># Pointer</span>
</span></span><span class="line"><span class="cl">    <span class="n">content_object</span> <span class="o">=</span> <span class="n">GenericForeignKey</span><span class="p">()</span>
</span></span></code></pre></div><ol>
<li>
<p><strong><code>ContentType</code> (å…§å®¹é¡å‹)</strong>: åœ¨ Django ä¸­ï¼Œ<code>ContentType</code> æ˜¯ä¸€å€‹æ¨¡å‹ï¼Œå®ƒç”¨ä¾†è¡¨ç¤ºå…¶ä»–æ¨¡å‹çš„é¡å‹ã€‚åœ¨é€™å€‹ç¨‹å¼ç¢¼ä¸­ï¼Œ<code>content_type</code> æ¬„ä½æ˜¯ä¸€å€‹å¤–éµï¼Œé—œè¯åˆ° <code>ContentType</code> æ¨¡å‹ã€‚é€™éº¼åšçš„å¥½è™•æ˜¯ï¼Œå®ƒå…è¨±ä½ å‹•æ…‹åœ°åƒç…§å…¶ä»–æ¨¡å‹ï¼Œè€Œä¸æ˜¯åœ¨ç¨‹å¼ç¢¼ä¸­ç›´æ¥å¯«æ­»æ¨¡å‹çš„åç¨±ã€‚é€™æ¨£çš„è¨­è¨ˆå¯ä»¥å¢åŠ å½ˆæ€§ï¼Œè®“ä½ çš„ç¨‹å¼ç¢¼æ›´å®¹æ˜“æ“´å±•å’Œä¿®æ”¹ï¼Œè€Œä¸éœ€è¦æ”¹å‹•å¤ªå¤šç¨‹å¼ç¢¼ã€‚</p>
</li>
<li>
<p><strong><code>GenericForeignKey</code> (é€šç”¨å¤–éµ)</strong>: <code>GenericForeignKey</code> æ˜¯ä¸€å€‹ç”¨æ–¼é—œè¯ä»»æ„æ¨¡å‹çš„ç‰¹æ®Šæ¬„ä½ã€‚åœ¨é€™å€‹ä¾‹å­ä¸­ï¼Œ<code>content_object</code> æ¬„ä½ä½¿ç”¨äº† <code>GenericForeignKey</code>ã€‚é€™æ„å‘³è‘— <code>LikeItem</code> æ¨¡å‹å¯ä»¥èˆ‡ä»»ä½•å…¶ä»–æ¨¡å‹å»ºç«‹é—œè¯ï¼Œè€Œä¸åƒ…åƒ…æ˜¯å›ºå®šçš„ä¸€å€‹æˆ–å¹¾å€‹æ¨¡å‹ã€‚é€šé <code>content_type</code> å’Œ <code>object_id</code> é€™å…©å€‹æ¬„ä½ï¼Œä½ å¯ä»¥å‹•æ…‹åœ°å»ºç«‹èˆ‡ä¸åŒæ¨¡å‹çš„é—œè¯ã€‚</p>
</li>
<li>
<p><strong><code>LikeItem</code> æ¨¡å‹</strong>: <code>LikeItem</code> æ˜¯ä¸€å€‹ç”¨æˆ¶é»è´Šçš„æ¨¡å‹ï¼Œå®ƒé—œè¯åˆ°äº†ä½¿ç”¨è€… (<code>user</code>) å’Œå…¶ä»–æ¨¡å‹ (<code>content_type</code> å’Œ <code>object_id</code> ç¢ºå®šçš„æ¨¡å‹)ã€‚é€™æ¨£çš„è¨­è¨ˆå…è¨±ä½ åœ¨ä¸ç¢ºå®šå…·é«”æ¨¡å‹çš„æƒ…æ³ä¸‹ï¼Œä¿å­˜ç”¨æˆ¶å°ä¸åŒé¡å‹ç‰©ä»¶çš„å–œæ„›ã€‚</p>
</li>
</ol>
<p>åœ¨ <code>LikeItem</code> æ¨¡å‹ä¸­ï¼Œ<code>content_type</code> æ˜¯ä¸€å€‹å¤–éµæ¬„ä½ï¼Œé—œè¯åˆ° <code>ContentType</code> æ¨¡å‹ï¼Œç”¨ä¾†æŒ‡å®šè¢«é»è´Šç‰©ä»¶çš„é¡å‹ï¼ˆä¾‹å¦‚ï¼Œæ˜¯ä¸€ç¯‡æ–‡ç« é‚„æ˜¯ä¸€å¼µåœ–ç‰‡ç­‰ç­‰ï¼‰ã€‚è€Œ <code>object_id</code> æ˜¯ä¸€å€‹æ­£æ•´æ•¸æ¬„ä½ï¼Œç”¨ä¾†æŒ‡å®šå…·é«”çš„è¢«é»è´Šç‰©ä»¶çš„ IDã€‚</p>
<p><code>GenericForeignKey</code> çš„ä½œç”¨å°±æ˜¯æŠŠ <code>content_type</code> å’Œ <code>object_id</code> é€™å…©å€‹æ¬„ä½é—œè¯åˆ°ä¸€å€‹å…·é«”çš„æ¨¡å‹å¯¦ä¾‹ä¸Šï¼Œé€™æ¨£ä½ å°±å¯ä»¥åœ¨ <code>LikeItem</code> ä¸­ä½¿ç”¨ <code>content_object</code> é€™å€‹å±¬æ€§ï¼Œç›´æ¥è¨ªå•è¢«é»è´Šçš„å…·é«”ç‰©ä»¶ï¼Œè€Œä¸éœ€è¦é—œå¿ƒå®ƒæ˜¯å“ªç¨®æ¨¡å‹ã€‚</p>
<p>ä¾‹å¦‚ï¼Œå¦‚æœ <code>content_type</code> æŒ‡å®šç‚ºæ–‡ç« ï¼Œ<code>object_id</code> æŒ‡å®šç‚ºæŸç¯‡æ–‡ç« çš„ IDï¼Œé‚£éº¼ <code>content_object</code> å°±å¯ä»¥ç›´æ¥è¨ªå•è©²ç¯‡æ–‡ç« çš„æ‰€æœ‰å±¬æ€§å’Œæ–¹æ³•ã€‚é€™æ¨£ï¼Œä½ å¯ä»¥åœ¨ä¸ç¢ºå®šå…·é«”æ¨¡å‹çš„æƒ…æ³ä¸‹ï¼Œå‹•æ…‹åœ°å»ºç«‹é—œè¯ï¼Œä½¿å¾—ç¨‹å¼ç¢¼æ›´åŠ éˆæ´»å’Œå¯æ“´å±•ã€‚</p>
<p>ä½ å¯ä»¥å°‡ <code>content_object</code> æƒ³åƒæˆç¨‹å¼èªè¨€ä¸­çš„æŒ‡æ¨™ <code>pointer</code>ã€‚åœ¨é€™å€‹ä¸Šä¸‹æ–‡ä¸­ï¼Œ<code>content_object</code> å¯¦éš›ä¸Šæ˜¯ä¸€å€‹é€šç”¨æŒ‡æ¨™ï¼ŒæŒ‡å‘äº†æ‡‰ç”¨ä¸­çš„ä»»ä½•ä¸€å€‹æ¨¡å‹çš„ç‰¹å®šå¯¦ä¾‹ã€‚é€™æ¨£çš„è¨­è¨ˆä½¿å¾—ä½ å¯ä»¥å‹•æ…‹åœ°æŒ‡å‘å’Œè¨ªå•ä¸åŒæ¨¡å‹çš„ç‰©ä»¶ï¼Œè€Œä¸éœ€è¦çŸ¥é“å…·é«”æ˜¯å“ªå€‹é¡å‹çš„ç‰©ä»¶ã€‚</p>
<p>å°±åƒæŒ‡æ¨™åœ¨ç¨‹å¼èªè¨€ä¸­å¯ä»¥æŒ‡å‘ä¸åŒçš„è®Šæ•¸æˆ–æ•¸æ“šçµæ§‹ï¼Œ<code>content_object</code> å…è¨±ä½ åœ¨ <code>LikeItem</code> æ¨¡å‹ä¸­æŒ‡å‘ä»»ä½•é¡å‹çš„ç‰©ä»¶ï¼Œå¾è€Œå¯¦ç¾å½ˆæ€§çš„è³‡æ–™æ¨¡å‹ã€‚é€™æ¨£çš„æŠ½è±¡è¨­è¨ˆä½¿å¾—ç¨‹å¼ç¢¼æ›´å…·é€šç”¨æ€§ï¼Œå¯ä»¥æ‡‰å°å¤šç¨®ä¸åŒçš„æƒ…æ³ï¼ŒåŒæ™‚ä¹Ÿä½¿å¾—ç¨‹å¼ç¢¼æ›´å®¹æ˜“æ“´å±•å’Œç¶­è­·ã€‚</p>
<hr>
<h2 id="generic-relationship---example">Generic Relationship - <strong>Example</strong></h2>
<p>å‡è¨­ä½ çš„å°è±¡æ˜¯ <code>Article</code>ï¼ˆæ–‡ç« ï¼‰æ¨¡å‹ï¼Œä½ å¯ä»¥ä½¿ç”¨ <code>GenericForeignKey</code> ä¾†å»ºç«‹ <code>LikeItem</code> èˆ‡ <code>Article</code> ä¹‹é–“çš„é—œè¯ã€‚ä»¥ä¸‹æ˜¯ä¸€å€‹ç°¡å–®çš„ç¯„ä¾‹ï¼š</p>
<p>é¦–å…ˆï¼Œå®šç¾©ä½ çš„ <code>Article</code> æ¨¡å‹ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">django.db</span> <span class="kn">import</span> <span class="n">models</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Article</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># æ–‡ç« çš„å±¬æ€§ï¼Œä¾‹å¦‚æ¨™é¡Œã€å…§å®¹ç­‰ç­‰</span>
</span></span><span class="line"><span class="cl">    <span class="n">title</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">content</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">TextField</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">title</span>
</span></span></code></pre></div><p>ç„¶å¾Œï¼Œå®šç¾©ä½ çš„ <code>LikeItem</code> æ¨¡å‹ï¼Œä½¿ç”¨ <code>GenericForeignKey</code> ä¾†å»ºç«‹é€šç”¨å¤–éµé—œè¯ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">django.contrib.contenttypes.fields</span> <span class="kn">import</span> <span class="n">GenericForeignKey</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">django.contrib.contenttypes.models</span> <span class="kn">import</span> <span class="n">ContentType</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">django.contrib.auth.models</span> <span class="kn">import</span> <span class="n">User</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">django.db</span> <span class="kn">import</span> <span class="n">models</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">LikeItem</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">user</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span><span class="n">User</span><span class="p">,</span> <span class="n">on_delete</span><span class="o">=</span><span class="n">models</span><span class="o">.</span><span class="n">CASCADE</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">content_type</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span><span class="n">ContentType</span><span class="p">,</span> <span class="n">on_delete</span><span class="o">=</span><span class="n">models</span><span class="o">.</span><span class="n">CASCADE</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">object_id</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">PositiveIntegerField</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">content_object</span> <span class="o">=</span> <span class="n">GenericForeignKey</span><span class="p">(</span><span class="s1">&#39;content_type&#39;</span><span class="p">,</span> <span class="s1">&#39;object_id&#39;</span><span class="p">)</span>
</span></span></code></pre></div><p>åœ¨é€™å€‹ä¾‹å­ä¸­ï¼Œ<code>LikeItem</code> æ¨¡å‹å¯ä»¥é—œè¯åˆ°ä»»ä½•æ¨¡å‹çš„å¯¦ä¾‹ï¼ŒåŒ…æ‹¬ <code>Article</code>ã€‚ç•¶ä½ æƒ³è¦ç‚ºæŸç¯‡æ–‡ç« å»ºç«‹ä¸€å€‹ <code>LikeItem</code> æ™‚ï¼Œä½ å¯ä»¥é€™æ¨£åšï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># å‰µå»ºä¸€ç¯‡æ–‡ç« </span>
</span></span><span class="line"><span class="cl"><span class="n">article</span> <span class="o">=</span> <span class="n">Article</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&#34;æ¨™é¡Œ&#34;</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="s2">&#34;æ–‡ç« å…§å®¹&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># å‰µå»ºä¸€å€‹ LikeItem é—œè¯åˆ°é€™ç¯‡æ–‡ç« </span>
</span></span><span class="line"><span class="cl"><span class="n">like_item</span> <span class="o">=</span> <span class="n">LikeItem</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">user</span><span class="o">=</span><span class="n">user</span><span class="p">,</span> <span class="n">content_type</span><span class="o">=</span><span class="n">ContentType</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get_for_model</span><span class="p">(</span><span class="n">article</span><span class="p">),</span> <span class="n">object_id</span><span class="o">=</span><span class="n">article</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ä½¿ç”¨ GenericForeignKey è¨ªå•è¢«é»è´Šçš„ç‰©ä»¶</span>
</span></span><span class="line"><span class="cl"><span class="n">liked_article</span> <span class="o">=</span> <span class="n">like_item</span><span class="o">.</span><span class="n">content_object</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">liked_article</span><span class="o">.</span><span class="n">title</span><span class="p">)</span>  <span class="c1"># è¼¸å‡º: æ¨™é¡Œ</span>
</span></span></code></pre></div><p>åœ¨é€™å€‹ä¾‹å­ä¸­ï¼Œ<code>content_type</code> æŒ‡å®šç‚º <code>Article</code> æ¨¡å‹çš„é¡å‹ï¼Œ<code>object_id</code> æŒ‡å®šç‚ºå…·é«”æ–‡ç« çš„ IDã€‚é€šé <code>GenericForeignKey</code>ï¼Œä½ å¯ä»¥ä½¿ç”¨ <code>content_object</code> ç›´æ¥è¨ªå•åˆ°è¢«é»è´Šçš„æ–‡ç« çš„å±¬æ€§ã€‚é€™æ¨£ï¼Œä½ å¯ä»¥å‹•æ…‹åœ°å»ºç«‹èˆ‡ä¸åŒæ¨¡å‹çš„é—œè¯ï¼Œè€Œä¸éœ€è¦ç‚ºæ¯ç¨®æ¨¡å‹éƒ½å®šç¾©ä¸€å€‹å–®ç¨çš„å¤–éµã€‚</p>
<hr>
<h2 id="reverse-relationship---example">Reverse Relationship - <strong>Example</strong></h2>
<p>åœ¨ Django ä¸­ï¼Œå¦‚æœä½ åœ¨ä¸€å€‹æ¨¡å‹ï¼ˆModelï¼‰ä¸­å®šç¾©äº†å¤–éµï¼ˆForeignKeyï¼‰æˆ–è€…ä¸€å°ä¸€ï¼ˆOneToOneFieldï¼‰é—œä¿‚ï¼ŒDjango æœƒè‡ªå‹•å¹«ä½ ç”Ÿæˆä¸€å€‹ç›¸æ‡‰çš„åå‘é—œä¿‚ï¼ˆreverse relationshipï¼‰ã€‚</p>
<p>å‡è¨­ä½ æœ‰å…©å€‹æ¨¡å‹ï¼Œä¸€å€‹æ˜¯<code>Author</code>ï¼Œå¦ä¸€å€‹æ˜¯<code>Book</code>ã€‚<code>Book</code>æ¨¡å‹æœ‰ä¸€å€‹å¤–éµæ¬„ä½æŒ‡å‘<code>Author</code>æ¨¡å‹ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">django.db</span> <span class="kn">import</span> <span class="n">models</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Author</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">name</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Book</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">title</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">author</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span><span class="n">Author</span><span class="p">,</span> <span class="n">on_delete</span><span class="o">=</span><span class="n">models</span><span class="o">.</span><span class="n">CASCADE</span><span class="p">)</span>
</span></span></code></pre></div><p>åœ¨é€™å€‹ä¾‹å­ä¸­ï¼Œ<code>Book</code>æ¨¡å‹æœ‰ä¸€å€‹å¤–éµæ¬„ä½<code>author</code>æŒ‡å‘<code>Author</code>æ¨¡å‹ã€‚Django æœƒè‡ªå‹•ç‚º<code>Author</code>æ¨¡å‹ç”Ÿæˆä¸€å€‹åå‘é—œä¿‚ã€‚é€™æ„å‘³è‘—ä½ å¯ä»¥é€é<code>Author</code>æ¨¡å‹ä¾†è¨ªå•æ‰€æœ‰èˆ‡ä¹‹ç›¸é—œè¯çš„æ›¸ç±ï¼Œå³ä½¿ä½ ä¸¦æ²’æœ‰åœ¨<code>Author</code>æ¨¡å‹ä¸­å®šç¾©ç›¸é—œçš„æ¬„ä½ã€‚</p>
<p>ä¾‹å¦‚ï¼Œå¦‚æœä½ æœ‰ä¸€å€‹<code>Author</code>çš„å¯¦ä¾‹<code>author</code>ï¼Œä½ å¯ä»¥é€™æ¨£ç²å–æ‰€æœ‰èˆ‡é€™å€‹ä½œè€…ç›¸é—œçš„æ›¸ç±ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">books</span> <span class="o">=</span> <span class="n">author</span><span class="o">.</span><span class="n">book_set</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
</span></span></code></pre></div><p>åœ¨é€™è£¡ï¼Œ<code>book_set</code>å°±æ˜¯ Django è‡ªå‹•ç‚º<code>Author</code>æ¨¡å‹ç”Ÿæˆçš„åå‘é—œä¿‚ã€‚é€™å€‹åç¨±çš„æ ¼å¼æ˜¯<code>å°å¯«çš„æ¨¡å‹åç¨±_set</code>ï¼Œå®ƒå¯ä»¥è®“ä½ è¨ªå•åˆ°æ‰€æœ‰èˆ‡é€™å€‹æ¨¡å‹ç›¸é—œçš„å°è±¡ã€‚é€™ç¨®åå‘é—œä¿‚çš„è‡ªå‹•ç”Ÿæˆä½¿å¾—åœ¨ Django ä¸­é€²è¡Œæ¨¡å‹ä¹‹é–“çš„æŸ¥è©¢å’Œæ“ä½œæ›´åŠ æ–¹ä¾¿ã€‚</p>
]]></content:encoded>
    </item>
    
    <item>
      <title>Django - Fundamental</title>
      <link>https://blog.cmwang.net/zh/posts/2020/10/django-fundamental/</link>
      <pubDate>Sat, 24 Oct 2020 02:47:41 +0800</pubDate>
      
      <guid>https://blog.cmwang.net/zh/posts/2020/10/django-fundamental/</guid>
      <description>Django - Fundamental</description>
      <content:encoded><![CDATA[<h3 id="create-project">Create Project</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">poetry init
</span></span><span class="line"><span class="cl">portry add django
</span></span><span class="line"><span class="cl">django-admin startproject my_site . <span class="c1"># period to current directory</span>
</span></span><span class="line"><span class="cl">python manage.py runserver <span class="o">[</span>9000<span class="o">]</span>   <span class="c1"># port is optional</span>
</span></span></code></pre></div><ul>
<li>Every Django project consists of multiple <code>apps</code>.</li>
</ul>
<h3 id="create-app">Create APP</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">python manage.py startapp playground
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">â”œâ”€â”€ manage.py
</span></span><span class="line"><span class="cl">â”œâ”€â”€ playground
</span></span><span class="line"><span class="cl">â”‚Â Â  â”œâ”€â”€ __init__.py
</span></span><span class="line"><span class="cl">â”‚Â Â  â”œâ”€â”€ admin.py
</span></span><span class="line"><span class="cl">â”‚Â Â  â”œâ”€â”€ apps.py 						# config setting
</span></span><span class="line"><span class="cl">â”‚Â Â  â”œâ”€â”€ migrations
</span></span><span class="line"><span class="cl">â”‚Â Â  â”‚Â Â  â””â”€â”€ __init__.py
</span></span><span class="line"><span class="cl">â”‚Â Â  â”œâ”€â”€ models.py
</span></span><span class="line"><span class="cl">â”‚Â Â  â”œâ”€â”€ tests.py
</span></span><span class="line"><span class="cl">â”‚Â Â  â””â”€â”€ views.py						# request handlers
</span></span></code></pre></div><h3 id="register-app">Register APP</h3>
<ul>
<li>you can use both methods.</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="c1"># settings.py</span>
</span></span><span class="line"><span class="cl"><span class="nv">INSTALLED_APPS</span> <span class="o">=</span> <span class="o">[</span>
</span></span><span class="line"><span class="cl">  <span class="c1"># ...</span>
</span></span><span class="line"><span class="cl">  <span class="s1">&#39;playground&#39;</span>,
</span></span><span class="line"><span class="cl">  <span class="c1"># ...</span>
</span></span><span class="line"><span class="cl"><span class="o">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># settings.py</span>
</span></span><span class="line"><span class="cl"><span class="nv">INSTALLED_APPS</span> <span class="o">=</span> <span class="o">[</span>
</span></span><span class="line"><span class="cl">  <span class="c1"># ...</span>
</span></span><span class="line"><span class="cl">  <span class="s1">&#39;playground.apps.PlaygroundConfig&#39;</span>,
</span></span><span class="line"><span class="cl">  <span class="c1"># ...</span>
</span></span><span class="line"><span class="cl"><span class="o">]</span>
</span></span></code></pre></div><h3 id="views">Views</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python3" data-lang="python3"><span class="line"><span class="cl"><span class="c1"># playground/views.py</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">django.shortcuts</span> <span class="kn">import</span> <span class="n">render</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">django.http</span> <span class="kn">import</span> <span class="n">HttpResponse</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">say_hello</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">HttpResponse</span><span class="p">(</span><span class="s1">&#39;Hello World&#39;</span><span class="p">)</span>
</span></span></code></pre></div><h3 id="maps-urls-to-views">Maps URLs to Views</h3>
<ul>
<li>setup urls.py in the app</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># playground/urls.py</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">django.urls</span> <span class="kn">import</span> <span class="nn">path</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">views</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># URLConf: need to be this variable name ğŸ’¡</span>
</span></span><span class="line"><span class="cl"><span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">  <span class="n">path</span><span class="p">(</span><span class="s1">&#39;playground/hello&#39;</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">say_hello</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">]</span>
</span></span></code></pre></div><ul>
<li>include the app&rsquo;s url in the project level</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># storefront/urls.py</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">django.contrib</span> <span class="kn">import</span> <span class="n">admin</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">django.urls</span> <span class="kn">import</span> <span class="n">path</span><span class="p">,</span> <span class="n">include</span> <span class="c1"># add include</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">  <span class="n">path</span><span class="p">(</span><span class="s1">&#39;admin/&#39;</span><span class="p">,</span> <span class="n">admin</span><span class="o">.</span><span class="n">site</span><span class="o">.</span><span class="n">urls</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">  <span class="n">path</span><span class="p">(</span><span class="s1">&#39;playground/&#39;</span><span class="p">,</span> <span class="n">include</span><span class="p">(</span><span class="s1">&#39;playground.urls&#39;</span><span class="p">))</span> <span class="c1"># add this</span>
</span></span><span class="line"><span class="cl"><span class="p">]</span>
</span></span></code></pre></div><h3 id="use-templates">Use Templates</h3>
<ul>
<li>create templates folder under playground and create a new file hello.html.</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="c">&lt;!-- playground/templates/hello.html --&gt;</span>
</span></span><span class="line"><span class="cl">{% if name %}
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span>Hello {{ name }}<span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">{% else %}
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span>Hello World<span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">{% endif %}
</span></span></code></pre></div><ul>
<li>refine the views.py (request handler)</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># playground/views.py</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">django.shortcuts</span> <span class="kn">import</span> <span class="n">render</span>
</span></span><span class="line"><span class="cl"><span class="c1">#from django.http import HttpResponse</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">say_hello</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s1">&#39;hello.html&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Jamie&#39;</span><span class="p">})</span>
</span></span></code></pre></div><h3 id="debug-tools">Debug Tools</h3>
<ul>
<li>VSCode: Create a <code>launch.json</code> file -&gt; select <code>django</code></li>
<li>Django Debug Toolbar: follow the <a href="https://django-debug-toolbar.readthedocs.io/en/latest/installation.html">instructions</a> ğŸ’</li>
</ul>
]]></content:encoded>
    </item>
    
  </channel>
</rss>
